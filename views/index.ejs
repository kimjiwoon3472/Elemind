<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì£¼ê¸°ìœ¨í‘œ - ì›ì†Œ ì•”ê¸°</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a77e0 0%, #0d5bb5 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(166, 206, 252, 0.5);
      padding: 20px 30px;
      border-radius: 15px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
    }

    .header h1 {
      color: #1a77e0;
      font-size: 24px;
      text-shadow: 0 2px 4px rgba(26, 119, 224, 0.1);
      margin: 0;
    }

    .user-info {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .username {
      color: #2a2a2a;
      font-weight: 600;
    }

    .logout-btn {
      padding: 8px 20px;
      background: linear-gradient(135deg, #1a77e0 0%, #0d5bb5 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(26, 119, 224, 0.3);
    }

    .logout-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(26, 119, 224, 0.4);
    }

    .menu-bar {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(166, 206, 252, 0.5);
      padding: 25px 30px;
      border-radius: 15px;
      margin-bottom: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .menu-btn {
      flex: 1;
      padding: 14px 8px;
      background: linear-gradient(135deg, #1a77e0 0%, #0d5bb5 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(26, 119, 224, 0.3);
    }

    .menu-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(26, 119, 224, 0.4);
    }

    .periodic-table-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(166, 206, 252, 0.5);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      max-width: 1400px;
      margin: 0 auto;
    }

    .periodic-table {
      display: grid;
      grid-template-columns: repeat(18, 1fr);
      gap: 8px;
      margin-bottom: 20px;
    }

    .lanthanides-actinides-container {
      display: grid;
      grid-template-columns: repeat(18, 1fr);
      gap: 8px;
      margin-top: 10px;
    }

    .spacer {
      grid-column: span 3;
    }

    .series-card .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .series-card .card-inner.flipped {
      transform: rotateY(180deg);
    }

    .series-indicator {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      background: linear-gradient(135deg, rgba(166, 206, 252, 0.8) 0%, rgba(125, 181, 245, 0.8) 100%);
      backdrop-filter: blur(5px);
      border: 2px solid rgba(26, 119, 224, 0.4);
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      font-size: 11px;
      font-weight: 600;
      color: #2a2a2a;
      text-align: center;
      cursor: pointer;
    }

    .series-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      background: linear-gradient(135deg, #a6cefc 0%, #7db5f5 100%);
      border: 2px solid rgba(26, 119, 224, 0.4);
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 8px;
      padding-top: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      color: #2a2a2a;
      cursor: pointer;
      transform: rotateY(180deg);
    }

    .element-card {
      aspect-ratio: 1;
      perspective: 1000px;
      cursor: pointer;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .element-card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      border: 2px solid rgba(166, 206, 252, 0.4);
    }

    .card-front {
      background: linear-gradient(135deg, #1a77e0 0%, #1561c4 100%);
      color: white;
      padding-top: 20px;
    }

    .card-back {
      background: linear-gradient(135deg, #a6cefc 0%, #7db5f5 100%);
      color: #2a2a2a;
      transform: rotateY(180deg);
      padding-top: 20px;
    }

    .element-number {
      position: absolute;
      top: 5px;
      left: 5px;
      font-size: 9px;
      font-weight: 600;
    }

    .element-symbol {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .element-name-ko {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .element-name-ko.small {
      font-size: 10px;
    }

    .element-name-en {
      font-size: 11px;
      opacity: 0.9;
    }

    .favorite-btn {
      position: absolute;
      top: 2px;
      right: 2px;
      background: transparent;
      border: none;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      transition: all 0.3s;
      z-index: 10;
      color: white;
    }

    .favorite-btn:hover {
      transform: scale(1.2);
      filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.8));
    }

    .favorite-btn.active {
      color: #ffd700;
      filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.8));
    }

    .empty-cell {
      background: transparent;
    }

    /* ì¡±ë³„ ìƒ‰ìƒ - íŒŒë€ìƒ‰ ê³„ì—´ í…Œë§ˆ */
    .alkali { 
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important; 
      border-color: rgba(239, 68, 68, 0.5) !important;
      color: white !important;
    }
    .alkaline-earth { 
      background: linear-gradient(135deg, #f97316 0%, #ea580c 100%) !important; 
      border-color: rgba(249, 115, 22, 0.5) !important;
      color: white !important;
    }
    .transition { 
      background: linear-gradient(135deg, #1a77e0 0%, #1561c4 100%) !important; 
      border-color: rgba(26, 119, 224, 0.5) !important;
      color: white !important;
    }
    .lanthanide { 
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%) !important; 
      border-color: rgba(139, 92, 246, 0.5) !important;
      color: white !important;
    }
    .actinide { 
      background: linear-gradient(135deg, #ec4899 0%, #db2777 100%) !important; 
      border-color: rgba(236, 72, 153, 0.5) !important;
      color: white !important;
    }
    .metalloid { 
      background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important; 
      border-color: rgba(16, 185, 129, 0.5) !important;
      color: white !important;
    }
    .nonmetal { 
      background: linear-gradient(135deg, #a6cefc 0%, #7db5f5 100%) !important; 
      border-color: rgba(166, 206, 252, 0.5) !important;
      color: #2a2a2a !important;
    }
    .halogen { 
      background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%) !important; 
      border-color: rgba(6, 182, 212, 0.5) !important;
      color: white !important;
    }
    .noble-gas { 
      background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%) !important; 
      border-color: rgba(99, 102, 241, 0.5) !important;
      color: white !important;
    }

    @media (max-width: 1200px) {
      .element-symbol {
        font-size: 18px;
      }
      .element-number {
        font-size: 9px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-left">
      <img src="/images/logo.png" alt="ë¡œê³ " class="logo">
      <h1>ì£¼ê¸°ìœ¨í‘œ ì•”ê¸° ë„ìš°ë¯¸ - Elemind</h1>
    </div>
    <div class="user-info">
      <span class="username">ğŸ‘¤ <%= username %></span>
      <button class="logout-btn" onclick="location.href='/logout'">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </div>

  <div class="menu-bar">
    <button class="menu-btn" onclick="window.open('/repeat-study', '_blank')">ë°˜ë³µ í•™ìŠµ</button>
    <button class="menu-btn" onclick="window.open('/multiple-choice', '_blank')">ê°ê´€ì‹ í•™ìŠµ</button>
    <button class="menu-btn" onclick="window.open('/short-answer', '_blank')">ì£¼ê´€ì‹ í•™ìŠµ</button>
    <button class="menu-btn" onclick="window.open('/test', '_blank')">í…ŒìŠ¤íŠ¸</button>
  </div>

  <div class="periodic-table-container">
    <div class="periodic-table" id="periodic-table"></div>
    <div class="lanthanides-actinides-container" id="lanthanides-actinides"></div>
  </div>

  <script>
    // ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ ì¦ê²¨ì°¾ê¸° ë°ì´í„°
    const userFavorites = <%- JSON.stringify(favorites) %>;
    
    // 118ê°œ ì „ì²´ ì›ì†Œ ë°ì´í„°
    const elements = [
      // 1ì£¼ê¸°
      { number: 1, symbol: 'H', nameKo: 'ìˆ˜ì†Œ', nameEn: 'Hydrogen', row: 1, col: 1, category: 'nonmetal' },
      { number: 2, symbol: 'He', nameKo: 'í—¬ë¥¨', nameEn: 'Helium', row: 1, col: 18, category: 'noble-gas' },
      
      // 2ì£¼ê¸°
      { number: 3, symbol: 'Li', nameKo: 'ë¦¬íŠ¬', nameEn: 'Lithium', row: 2, col: 1, category: 'alkali' },
      { number: 4, symbol: 'Be', nameKo: 'ë² ë¦´ë¥¨', nameEn: 'Beryllium', row: 2, col: 2, category: 'alkaline-earth' },
      { number: 5, symbol: 'B', nameKo: 'ë¶•ì†Œ', nameEn: 'Boron', row: 2, col: 13, category: 'metalloid' },
      { number: 6, symbol: 'C', nameKo: 'íƒ„ì†Œ', nameEn: 'Carbon', row: 2, col: 14, category: 'nonmetal' },
      { number: 7, symbol: 'N', nameKo: 'ì§ˆì†Œ', nameEn: 'Nitrogen', row: 2, col: 15, category: 'nonmetal' },
      { number: 8, symbol: 'O', nameKo: 'ì‚°ì†Œ', nameEn: 'Oxygen', row: 2, col: 16, category: 'nonmetal' },
      { number: 9, symbol: 'F', nameKo: 'í”Œë£¨ì˜¤ë¦°', nameEn: 'Fluorine', row: 2, col: 17, category: 'halogen' },
      { number: 10, symbol: 'Ne', nameKo: 'ë„¤ì˜¨', nameEn: 'Neon', row: 2, col: 18, category: 'noble-gas' },
      
      // 3ì£¼ê¸°
      { number: 11, symbol: 'Na', nameKo: 'ë‚˜íŠ¸ë¥¨', nameEn: 'Sodium', row: 3, col: 1, category: 'alkali' },
      { number: 12, symbol: 'Mg', nameKo: 'ë§ˆê·¸ë„¤ìŠ˜', nameEn: 'Magnesium', row: 3, col: 2, category: 'alkaline-earth' },
      { number: 13, symbol: 'Al', nameKo: 'ì•Œë£¨ë¯¸ëŠ„', nameEn: 'Aluminum', row: 3, col: 13, category: 'transition' },
      { number: 14, symbol: 'Si', nameKo: 'ê·œì†Œ', nameEn: 'Silicon', row: 3, col: 14, category: 'metalloid' },
      { number: 15, symbol: 'P', nameKo: 'ì¸', nameEn: 'Phosphorus', row: 3, col: 15, category: 'nonmetal' },
      { number: 16, symbol: 'S', nameKo: 'í™©', nameEn: 'Sulfur', row: 3, col: 16, category: 'nonmetal' },
      { number: 17, symbol: 'Cl', nameKo: 'ì—¼ì†Œ', nameEn: 'Chlorine', row: 3, col: 17, category: 'halogen' },
      { number: 18, symbol: 'Ar', nameKo: 'ì•„ë¥´ê³¤', nameEn: 'Argon', row: 3, col: 18, category: 'noble-gas' },
      
      // 4ì£¼ê¸°
      { number: 19, symbol: 'K', nameKo: 'ì¹¼ë¥¨', nameEn: 'Potassium', row: 4, col: 1, category: 'alkali' },
      { number: 20, symbol: 'Ca', nameKo: 'ì¹¼ìŠ˜', nameEn: 'Calcium', row: 4, col: 2, category: 'alkaline-earth' },
      { number: 21, symbol: 'Sc', nameKo: 'ìŠ¤ì¹¸ë“', nameEn: 'Scandium', row: 4, col: 3, category: 'transition' },
      { number: 22, symbol: 'Ti', nameKo: 'íƒ€ì´íƒ€ëŠ„', nameEn: 'Titanium', row: 4, col: 4, category: 'transition' },
      { number: 23, symbol: 'V', nameKo: 'ë°”ë‚˜ë“', nameEn: 'Vanadium', row: 4, col: 5, category: 'transition' },
      { number: 24, symbol: 'Cr', nameKo: 'í¬ë¡œë®´', nameEn: 'Chromium', row: 4, col: 6, category: 'transition' },
      { number: 25, symbol: 'Mn', nameKo: 'ë§ê°€ë‹ˆì¦ˆ', nameEn: 'Manganese', row: 4, col: 7, category: 'transition' },
      { number: 26, symbol: 'Fe', nameKo: 'ì² ', nameEn: 'Iron', row: 4, col: 8, category: 'transition' },
      { number: 27, symbol: 'Co', nameKo: 'ì½”ë°œíŠ¸', nameEn: 'Cobalt', row: 4, col: 9, category: 'transition' },
      { number: 28, symbol: 'Ni', nameKo: 'ë‹ˆì¼ˆ', nameEn: 'Nickel', row: 4, col: 10, category: 'transition' },
      { number: 29, symbol: 'Cu', nameKo: 'êµ¬ë¦¬', nameEn: 'Copper', row: 4, col: 11, category: 'transition' },
      { number: 30, symbol: 'Zn', nameKo: 'ì•„ì—°', nameEn: 'Zinc', row: 4, col: 12, category: 'transition' },
      { number: 31, symbol: 'Ga', nameKo: 'ê°ˆë¥¨', nameEn: 'Gallium', row: 4, col: 13, category: 'transition' },
      { number: 32, symbol: 'Ge', nameKo: 'ì €ë§ˆëŠ„', nameEn: 'Germanium', row: 4, col: 14, category: 'metalloid' },
      { number: 33, symbol: 'As', nameKo: 'ë¹„ì†Œ', nameEn: 'Arsenic', row: 4, col: 15, category: 'metalloid' },
      { number: 34, symbol: 'Se', nameKo: 'ì…€ë ˆëŠ„', nameEn: 'Selenium', row: 4, col: 16, category: 'nonmetal' },
      { number: 35, symbol: 'Br', nameKo: 'ë¸Œë¡œë¯¼', nameEn: 'Bromine', row: 4, col: 17, category: 'halogen' },
      { number: 36, symbol: 'Kr', nameKo: 'í¬ë¦½í†¤', nameEn: 'Krypton', row: 4, col: 18, category: 'noble-gas' },
      
      // 5ì£¼ê¸°
      { number: 37, symbol: 'Rb', nameKo: 'ë£¨ë¹„ë“', nameEn: 'Rubidium', row: 5, col: 1, category: 'alkali' },
      { number: 38, symbol: 'Sr', nameKo: 'ìŠ¤íŠ¸ë¡ íŠ¬', nameEn: 'Strontium', row: 5, col: 2, category: 'alkaline-earth' },
      { number: 39, symbol: 'Y', nameKo: 'ì´íŠ¸ë¥¨', nameEn: 'Yttrium', row: 5, col: 3, category: 'transition' },
      { number: 40, symbol: 'Zr', nameKo: 'ì§€ë¥´ì½”ëŠ„', nameEn: 'Zirconium', row: 5, col: 4, category: 'transition' },
      { number: 41, symbol: 'Nb', nameKo: 'ë‚˜ì´ì˜¤ë¸€', nameEn: 'Niobium', row: 5, col: 5, category: 'transition' },
      { number: 42, symbol: 'Mo', nameKo: 'ëª°ë¦¬ë¸Œë°ë„˜', nameEn: 'Molybdenum', row: 5, col: 6, category: 'transition' },
      { number: 43, symbol: 'Tc', nameKo: 'í…Œí¬ë„¤íŠ¬', nameEn: 'Technetium', row: 5, col: 7, category: 'transition' },
      { number: 44, symbol: 'Ru', nameKo: 'ë£¨í…ŒëŠ„', nameEn: 'Ruthenium', row: 5, col: 8, category: 'transition' },
      { number: 45, symbol: 'Rh', nameKo: 'ë¡œë“', nameEn: 'Rhodium', row: 5, col: 9, category: 'transition' },
      { number: 46, symbol: 'Pd', nameKo: 'íŒ”ë¼ë“', nameEn: 'Palladium', row: 5, col: 10, category: 'transition' },
      { number: 47, symbol: 'Ag', nameKo: 'ì€', nameEn: 'Silver', row: 5, col: 11, category: 'transition' },
      { number: 48, symbol: 'Cd', nameKo: 'ì¹´ë“œë®´', nameEn: 'Cadmium', row: 5, col: 12, category: 'transition' },
      { number: 49, symbol: 'In', nameKo: 'ì¸ë“', nameEn: 'Indium', row: 5, col: 13, category: 'transition' },
      { number: 50, symbol: 'Sn', nameKo: 'ì£¼ì„', nameEn: 'Tin', row: 5, col: 14, category: 'transition' },
      { number: 51, symbol: 'Sb', nameKo: 'ì•ˆí‹°ëª¨ë‹ˆ', nameEn: 'Antimony', row: 5, col: 15, category: 'metalloid' },
      { number: 52, symbol: 'Te', nameKo: 'í…”ë£¨ë¥¨', nameEn: 'Tellurium', row: 5, col: 16, category: 'metalloid' },
      { number: 53, symbol: 'I', nameKo: 'ì•„ì´ì˜¤ë”˜', nameEn: 'Iodine', row: 5, col: 17, category: 'halogen' },
      { number: 54, symbol: 'Xe', nameKo: 'ì œë…¼', nameEn: 'Xenon', row: 5, col: 18, category: 'noble-gas' },
      
      // 6ì£¼ê¸°
      { number: 55, symbol: 'Cs', nameKo: 'ì„¸ìŠ˜', nameEn: 'Cesium', row: 6, col: 1, category: 'alkali' },
      { number: 56, symbol: 'Ba', nameKo: 'ë°”ë¥¨', nameEn: 'Barium', row: 6, col: 2, category: 'alkaline-earth' },
      { number: 57, symbol: 'La', nameKo: 'ë€íƒ€ë„˜', nameEn: 'Lanthanum', row: 9, col: 1, category: 'lanthanide' },
      { number: 58, symbol: 'Ce', nameKo: 'ì„¸ë¥¨', nameEn: 'Cerium', row: 9, col: 2, category: 'lanthanide' },
      { number: 59, symbol: 'Pr', nameKo: 'í”„ë¼ì„¸ì˜¤ë””ë®´', nameEn: 'Praseodymium', row: 9, col: 3, category: 'lanthanide' },
      { number: 60, symbol: 'Nd', nameKo: 'ë„¤ì˜¤ë””ë®´', nameEn: 'Neodymium', row: 9, col: 4, category: 'lanthanide' },
      { number: 61, symbol: 'Pm', nameKo: 'í”„ë¡œë©”íŠ¬', nameEn: 'Promethium', row: 9, col: 5, category: 'lanthanide' },
      { number: 62, symbol: 'Sm', nameKo: 'ì‚¬ë§ˆë¥¨', nameEn: 'Samarium', row: 9, col: 6, category: 'lanthanide' },
      { number: 63, symbol: 'Eu', nameKo: 'ìœ ë¡œí“¸', nameEn: 'Europium', row: 9, col: 7, category: 'lanthanide' },
      { number: 64, symbol: 'Gd', nameKo: 'ê°€ëŒë¦¬ëŠ„', nameEn: 'Gadolinium', row: 9, col: 8, category: 'lanthanide' },
      { number: 65, symbol: 'Tb', nameKo: 'í„°ë¸€', nameEn: 'Terbium', row: 9, col: 9, category: 'lanthanide' },
      { number: 66, symbol: 'Dy', nameKo: 'ë””ìŠ¤í”„ë¡œìŠ˜', nameEn: 'Dysprosium', row: 9, col: 10, category: 'lanthanide' },
      { number: 67, symbol: 'Ho', nameKo: 'í™€ë®´', nameEn: 'Holmium', row: 9, col: 11, category: 'lanthanide' },
      { number: 68, symbol: 'Er', nameKo: 'ì–´ë¸€', nameEn: 'Erbium', row: 9, col: 12, category: 'lanthanide' },
      { number: 69, symbol: 'Tm', nameKo: 'íˆ´ë¥¨', nameEn: 'Thulium', row: 9, col: 13, category: 'lanthanide' },
      { number: 70, symbol: 'Yb', nameKo: 'ì´í„°ë¸€', nameEn: 'Ytterbium', row: 9, col: 14, category: 'lanthanide' },
      { number: 71, symbol: 'Lu', nameKo: 'ë£¨í…ŒíŠ¬', nameEn: 'Lutetium', row: 9, col: 15, category: 'lanthanide' },
      { number: 72, symbol: 'Hf', nameKo: 'í•˜í”„ëŠ„', nameEn: 'Hafnium', row: 6, col: 4, category: 'transition' },
      { number: 73, symbol: 'Ta', nameKo: 'íƒ„íƒˆëŸ¼', nameEn: 'Tantalum', row: 6, col: 5, category: 'transition' },
      { number: 74, symbol: 'W', nameKo: 'í……ìŠ¤í…', nameEn: 'Tungsten', row: 6, col: 6, category: 'transition' },
      { number: 75, symbol: 'Re', nameKo: 'ë ˆëŠ„', nameEn: 'Rhenium', row: 6, col: 7, category: 'transition' },
      { number: 76, symbol: 'Os', nameKo: 'ì˜¤ìŠ¤ë®´', nameEn: 'Osmium', row: 6, col: 8, category: 'transition' },
      { number: 77, symbol: 'Ir', nameKo: 'ì´ë¦¬ë“', nameEn: 'Iridium', row: 6, col: 9, category: 'transition' },
      { number: 78, symbol: 'Pt', nameKo: 'ë°±ê¸ˆ', nameEn: 'Platinum', row: 6, col: 10, category: 'transition' },
      { number: 79, symbol: 'Au', nameKo: 'ê¸ˆ', nameEn: 'Gold', row: 6, col: 11, category: 'transition' },
      { number: 80, symbol: 'Hg', nameKo: 'ìˆ˜ì€', nameEn: 'Mercury', row: 6, col: 12, category: 'transition' },
      { number: 81, symbol: 'Tl', nameKo: 'íƒˆë¥¨', nameEn: 'Thallium', row: 6, col: 13, category: 'transition' },
      { number: 82, symbol: 'Pb', nameKo: 'ë‚©', nameEn: 'Lead', row: 6, col: 14, category: 'transition' },
      { number: 83, symbol: 'Bi', nameKo: 'ë¹„ìŠ¤ë¬´íŠ¸', nameEn: 'Bismuth', row: 6, col: 15, category: 'transition' },
      { number: 84, symbol: 'Po', nameKo: 'í´ë¡œëŠ„', nameEn: 'Polonium', row: 6, col: 16, category: 'metalloid' },
      { number: 85, symbol: 'At', nameKo: 'ì•„ìŠ¤íƒ€í‹´', nameEn: 'Astatine', row: 6, col: 17, category: 'halogen' },
      { number: 86, symbol: 'Rn', nameKo: 'ë¼ëˆ', nameEn: 'Radon', row: 6, col: 18, category: 'noble-gas' },
      
      // 7ì£¼ê¸°
      { number: 87, symbol: 'Fr', nameKo: 'í”„ë‘ìŠ˜', nameEn: 'Francium', row: 7, col: 1, category: 'alkali' },
      { number: 88, symbol: 'Ra', nameKo: 'ë¼ë“', nameEn: 'Radium', row: 7, col: 2, category: 'alkaline-earth' },
      { number: 89, symbol: 'Ac', nameKo: 'ì•…í‹°ëŠ„', nameEn: 'Actinium', row: 10, col: 1, category: 'actinide' },
      { number: 90, symbol: 'Th', nameKo: 'í† ë¥¨', nameEn: 'Thorium', row: 10, col: 2, category: 'actinide' },
      { number: 91, symbol: 'Pa', nameKo: 'í”„ë¡œíŠ¸ì•…í‹°ëŠ„', nameEn: 'Protactinium', row: 10, col: 3, category: 'actinide' },
      { number: 92, symbol: 'U', nameKo: 'ìš°ë¼ëŠ„', nameEn: 'Uranium', row: 10, col: 4, category: 'actinide' },
      { number: 93, symbol: 'Np', nameKo: 'ë„µíˆ¬ëŠ„', nameEn: 'Neptunium', row: 10, col: 5, category: 'actinide' },
      { number: 94, symbol: 'Pu', nameKo: 'í”Œë£¨í† ëŠ„', nameEn: 'Plutonium', row: 10, col: 6, category: 'actinide' },
      { number: 95, symbol: 'Am', nameKo: 'ì•„ë©”ë¦¬ìŠ˜', nameEn: 'Americium', row: 10, col: 7, category: 'actinide' },
      { number: 96, symbol: 'Cm', nameKo: 'í€´ë¥¨', nameEn: 'Curium', row: 10, col: 8, category: 'actinide' },
      { number: 97, symbol: 'Bk', nameKo: 'ë²„í´ë¥¨', nameEn: 'Berkelium', row: 10, col: 9, category: 'actinide' },
      { number: 98, symbol: 'Cf', nameKo: 'ìº˜ë¦¬í¬ëŠ„', nameEn: 'Californium', row: 10, col: 10, category: 'actinide' },
      { number: 99, symbol: 'Es', nameKo: 'ì•„ì¸ìŠˆíƒ€ì´ëŠ„', nameEn: 'Einsteinium', row: 10, col: 11, category: 'actinide' },
      { number: 100, symbol: 'Fm', nameKo: 'í˜ë¥´ë®´', nameEn: 'Fermium', row: 10, col: 12, category: 'actinide' },
      { number: 101, symbol: 'Md', nameKo: 'ë©˜ë¸ë ˆë¸€', nameEn: 'Mendelevium', row: 10, col: 13, category: 'actinide' },
      { number: 102, symbol: 'No', nameKo: 'ë…¸ë²¨ë¥¨', nameEn: 'Nobelium', row: 10, col: 14, category: 'actinide' },
      { number: 103, symbol: 'Lr', nameKo: 'ë¡œë ŒìŠ˜', nameEn: 'Lawrencium', row: 10, col: 15, category: 'actinide' },
      { number: 104, symbol: 'Rf', nameKo: 'ëŸ¬ë”í¬ë“', nameEn: 'Rutherfordium', row: 7, col: 4, category: 'transition' },
      { number: 105, symbol: 'Db', nameKo: 'ë”ë¸ŒëŠ„', nameEn: 'Dubnium', row: 7, col: 5, category: 'transition' },
      { number: 106, symbol: 'Sg', nameKo: 'ì‹œë³´ê·¬', nameEn: 'Seaborgium', row: 7, col: 6, category: 'transition' },
      { number: 107, symbol: 'Bh', nameKo: 'ë³´ë¥¨', nameEn: 'Bohrium', row: 7, col: 7, category: 'transition' },
      { number: 108, symbol: 'Hs', nameKo: 'í•˜ìŠ˜', nameEn: 'Hassium', row: 7, col: 8, category: 'transition' },
      { number: 109, symbol: 'Mt', nameKo: 'ë§ˆì´íŠ¸ë„ˆë¥¨', nameEn: 'Meitnerium', row: 7, col: 9, category: 'transition' },
      { number: 110, symbol: 'Ds', nameKo: 'ë‹¤ë¦„ìŠˆíƒ€íŠ¬', nameEn: 'Darmstadtium', row: 7, col: 10, category: 'transition' },
      { number: 111, symbol: 'Rg', nameKo: 'ë¢´íŠ¸ê²ŒëŠ„', nameEn: 'Roentgenium', row: 7, col: 11, category: 'transition' },
      { number: 112, symbol: 'Cn', nameKo: 'ì½”í˜ë¥´ë‹ˆìŠ˜', nameEn: 'Copernicium', row: 7, col: 12, category: 'transition' },
      { number: 113, symbol: 'Nh', nameKo: 'ë‹ˆí˜¸ëŠ„', nameEn: 'Nihonium', row: 7, col: 13, category: 'transition' },
      { number: 114, symbol: 'Fl', nameKo: 'í”Œë ˆë¡œë¸€', nameEn: 'Flerovium', row: 7, col: 14, category: 'transition' },
      { number: 115, symbol: 'Mc', nameKo: 'ëª¨ìŠ¤ì½”ë¸€', nameEn: 'Moscovium', row: 7, col: 15, category: 'transition' },
      { number: 116, symbol: 'Lv', nameKo: 'ë¦¬ë²„ëª¨ë¥¨', nameEn: 'Livermorium', row: 7, col: 16, category: 'transition' },
      { number: 117, symbol: 'Ts', nameKo: 'í…Œë„¤ì‹ ', nameEn: 'Tennessine', row: 7, col: 17, category: 'halogen' },
      { number: 118, symbol: 'Og', nameKo: 'ì˜¤ê°€ë„¤ì†', nameEn: 'Oganesson', row: 7, col: 18, category: 'noble-gas' }
    ];

    function createPeriodicTable() {
      const mainTable = document.getElementById('periodic-table');
      const lanthActContainer = document.getElementById('lanthanides-actinides');
      
      // ë©”ì¸ ì£¼ê¸°ìœ¨í‘œ (1-7ì£¼ê¸°)
      for (let row = 1; row <= 7; row++) {
        for (let col = 1; col <= 18; col++) {
          const element = elements.find(e => e.row === row && e.col === col);
          
          if (element) {
            const card = createElementCard(element);
            mainTable.appendChild(card);
          } else if ((row === 6 && col === 3) || (row === 7 && col === 3)) {
            // 6ì£¼ê¸° 3ë²ˆ: 57-71 í‘œì‹œì, 7ì£¼ê¸° 3ë²ˆ: 89-103 í‘œì‹œì
            const seriesType = row === 6 ? 'lanthanide' : 'actinide';
            const seriesNumber = row === 6 ? 9001 : 9002; // í‘œì‹œ ì¹´ë“œ ì „ìš© ë²ˆí˜¸
            const isFavoriteSeries = userFavorites.includes(seriesNumber);
            
            const indicator = document.createElement('div');
            indicator.className = 'element-card series-card';
            indicator.dataset.series = seriesType;
            indicator.dataset.number = seriesNumber;
            
            const cardInner = document.createElement('div');
            cardInner.className = 'card-inner';
            
            const frontDiv = document.createElement('div');
            frontDiv.className = 'series-indicator';
            frontDiv.innerHTML = `
              <button class="favorite-btn ${isFavoriteSeries ? 'active' : ''}" onclick="toggleFavorite(event, ${seriesNumber}, true)">
                ${isFavoriteSeries ? 'âœ¦' : 'âœ§'}
              </button>
              <div style="font-size: 9px; margin-bottom: 2px;">${row === 6 ? '57-71' : '89-103'}</div>
              <div style="font-size: 13px; font-weight: bold;">${row === 6 ? 'La-Lu' : 'Ac-Lr'}</div>
            `;
            
            const backDiv = document.createElement('div');
            backDiv.className = 'series-card-back';
            backDiv.innerHTML = `
              <button class="favorite-btn ${isFavoriteSeries ? 'active' : ''}" onclick="toggleFavorite(event, ${seriesNumber}, true)">
                ${isFavoriteSeries ? 'âœ¦' : 'âœ§'}
              </button>
              <div class="element-name-ko small">${row === 6 ? 'ë€íƒ€ë„˜ì¡±' : 'ì•…í‹°ëŠ„ì¡±'}</div>
              <div class="element-name-en">${row === 6 ? 'Lanthanide' : 'Actinides'}</div>
            `;
            
            cardInner.appendChild(frontDiv);
            cardInner.appendChild(backDiv);
            indicator.appendChild(cardInner);
            
            // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            indicator.addEventListener('click', (e) => {
              if (!e.target.classList.contains('favorite-btn')) {
                cardInner.classList.toggle('flipped');
              }
            });
            
            mainTable.appendChild(indicator);
          } else {
            const emptyCell = document.createElement('div');
            emptyCell.className = 'empty-cell';
            mainTable.appendChild(emptyCell);
          }
        }
      }
      
      // ë€íƒ€ë„˜ì¡± (57-71ë²ˆ) - ì™¼ìª½ì— 3ì¹¸ ê³µë°± ì¶”ê°€
      const spacer1 = document.createElement('div');
      spacer1.className = 'spacer';
      lanthActContainer.appendChild(spacer1);
      
      for (let col = 1; col <= 15; col++) {
        const element = elements.find(e => e.row === 9 && e.col === col);
        if (element) {
          const card = createElementCard(element);
          lanthActContainer.appendChild(card);
        }
      }
      
      // ì•…í‹°ëŠ„ì¡± (89-103ë²ˆ) - ì™¼ìª½ì— 3ì¹¸ ê³µë°± ì¶”ê°€
      const spacer2 = document.createElement('div');
      spacer2.className = 'spacer';
      lanthActContainer.appendChild(spacer2);
      
      for (let col = 1; col <= 15; col++) {
        const element = elements.find(e => e.row === 10 && e.col === col);
        if (element) {
          const card = createElementCard(element);
          lanthActContainer.appendChild(card);
        }
      }
    }

    function createElementCard(element) {
      const card = document.createElement('div');
      card.className = 'element-card';
      card.dataset.number = element.number;
      
      const isFavorite = userFavorites.includes(element.number);
      
      // í•œê¸€ ì´ë¦„ì´ 4ê¸€ì ì´ìƒì´ë©´ small í´ë˜ìŠ¤ ì¶”ê°€
      const koNameClass = element.nameKo.length >= 4 ? 'element-name-ko small' : 'element-name-ko';
      
      card.innerHTML = `
        <div class="card-inner">
          <div class="card-front ${element.category}">
            <button class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite(event, ${element.number})">
              ${isFavorite ? 'âœ¦' : 'âœ§'}
            </button>
            <div class="element-number">${element.number}</div>
            <div class="element-symbol">${element.symbol}</div>
          </div>
          <div class="card-back">
            <button class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite(event, ${element.number})">
              ${isFavorite ? 'âœ¦' : 'âœ§'}
            </button>
            <div class="${koNameClass}">${element.nameKo}</div>
            <div class="element-name-en">${element.nameEn}</div>
          </div>
        </div>
      `;
      
      card.addEventListener('click', (e) => {
        if (!e.target.classList.contains('favorite-btn')) {
          card.classList.toggle('flipped');
        }
      });
      
      return card;
    }

    async function toggleFavorite(event, elementNumber, isSeriesButton = false) {
      event.stopPropagation();
      
      try {
        // ê³„ì—´ ë²„íŠ¼(La-Lu, Ac-Lr)ì¸ ê²½ìš°
        if (isSeriesButton && (elementNumber === 9001 || elementNumber === 9002)) {
          const seriesNumbers = elementNumber === 9001 
            ? Array.from({length: 15}, (_, i) => 57 + i)  // 57-71
            : Array.from({length: 15}, (_, i) => 89 + i); // 89-103
          
          // í˜„ì¬ í‘œì‹œ ì¹´ë“œì˜ ì¦ê²¨ì°¾ê¸° ìƒíƒœ í™•ì¸
          const seriesButton = document.querySelector(`[data-number="${elementNumber}"] .favorite-btn`);
          const isCurrentlyFavorite = seriesButton.classList.contains('active');
          
          // ì „ì²´ë¥¼ ì¶”ê°€ ë˜ëŠ” ì œê±°
          const action = isCurrentlyFavorite ? 'remove' : 'add';
          
          // í‘œì‹œ ì¹´ë“œ ìì²´ë„ í¬í•¨
          const allNumbers = [elementNumber, ...seriesNumbers];
          
          for (const num of allNumbers) {
            const response = await fetch('/api/favorite-batch', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ 
                elementNumber: num,
                action: action
              })
            });
          }
          
          // ëª¨ë“  ìš”ì²­ í›„ ìµœì¢… ì¦ê²¨ì°¾ê¸° ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
          const finalResponse = await fetch('/api/favorites', {
            method: 'GET',
            headers: {
              'Content-Type': 'application/json'
            }
          });
          
          const finalData = await finalResponse.json();
          
          if (finalData.success) {
            // ëª¨ë“  ê´€ë ¨ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            allNumbers.forEach(num => {
              const buttons = document.querySelectorAll(`[data-number="${num}"] .favorite-btn`);
              buttons.forEach(btn => {
                if (finalData.favorites.includes(num)) {
                  btn.classList.add('active');
                  btn.textContent = 'âœ¦';
                } else {
                  btn.classList.remove('active');
                  btn.textContent = 'âœ§';
                }
              });
            });
          }
        } else {
          // ê°œë³„ ì›ì†Œ í† ê¸€
          const response = await fetch('/api/favorite', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ elementNumber })
          });
          
          const data = await response.json();
          
          if (data.success) {
            // í† ê¸€í•œ ì›ì†Œ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            const buttons = document.querySelectorAll(`[data-number="${elementNumber}"] .favorite-btn`);
            buttons.forEach(btn => {
              if (data.favorites.includes(elementNumber)) {
                btn.classList.add('active');
                btn.textContent = 'âœ¦';
              } else {
                btn.classList.remove('active');
                btn.textContent = 'âœ§';
              }
            });
            
            // ë€íƒ€ë„˜ì¡±(57-71) ë˜ëŠ” ì•…í‹°ëŠ„ì¡±(89-103)ì— ì†í•œ ì›ì†Œì¸ ê²½ìš°
            let seriesCardNumber = null;
            let seriesNumbers = [];
            
            if (elementNumber >= 57 && elementNumber <= 71) {
              seriesCardNumber = 9001;
              seriesNumbers = Array.from({length: 15}, (_, i) => 57 + i);
            } else if (elementNumber >= 89 && elementNumber <= 103) {
              seriesCardNumber = 9002;
              seriesNumbers = Array.from({length: 15}, (_, i) => 89 + i);
            }
            
            // í•´ë‹¹ ê³„ì—´ì˜ í‘œì‹œ ì¹´ë“œê°€ ìˆë‹¤ë©´ ìƒíƒœ í™•ì¸ ë° ì—…ë°ì´íŠ¸
            if (seriesCardNumber) {
              // ê³„ì—´ ì „ì²´ê°€ ì¦ê²¨ì°¾ê¸°ì¸ì§€ í™•ì¸
              const allFavorited = seriesNumbers.every(num => data.favorites.includes(num));
              
              // í‘œì‹œ ì¹´ë“œ ì—…ë°ì´íŠ¸
              const seriesButtons = document.querySelectorAll(`[data-number="${seriesCardNumber}"] .favorite-btn`);
              seriesButtons.forEach(btn => {
                if (allFavorited) {
                  btn.classList.add('active');
                  btn.textContent = 'âœ¦';
                } else {
                  btn.classList.remove('active');
                  btn.textContent = 'âœ§';
                }
              });
              
              // í‘œì‹œ ì¹´ë“œ ìì²´ì˜ ì¦ê²¨ì°¾ê¸°ë„ DBì—ì„œ ì—…ë°ì´íŠ¸
              if (allFavorited && !data.favorites.includes(seriesCardNumber)) {
                await fetch('/api/favorite-batch', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json'
                  },
                  body: JSON.stringify({ 
                    elementNumber: seriesCardNumber,
                    action: 'add'
                  })
                });
              } else if (!allFavorited && data.favorites.includes(seriesCardNumber)) {
                await fetch('/api/favorite-batch', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json'
                  },
                  body: JSON.stringify({ 
                    elementNumber: seriesCardNumber,
                    action: 'remove'
                  })
                });
              }
            }
          }
        }
      } catch (error) {
        console.error('Error toggling favorite:', error);
      }
    }

    createPeriodicTable();
  </script>
</body>
</html>